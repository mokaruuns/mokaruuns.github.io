<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="theme-color" content="#0f1220" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <link rel="manifest" href="manifest.webmanifest" />
  <link rel="apple-touch-icon" href="icons/icon-512.svg" />
  <title>Calm & Focus — дыхательные практики</title>
  <meta name="description" content="Простое офлайн-приложение для дыхательных практик: 4-4-4-4, 4-7-8, когерентное, свой режим. Без рекламы и подписок." />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="app" role="application" aria-label="Дыхательные практики для спокойствия и фокуса">
    <header>
      <h1>Calm & Focus</h1>
      <div class="meta">Просто дышите. Без подписок и рекламы.</div>
      <button id="togglePanel" class="btn small ghost" type="button" aria-expanded="true">Скрыть настройки</button>
    </header>

    <section class="controls" aria-label="Настройки">
      <div class="field">
        <label for="mode">Режим дыхания</label>
        <select id="mode">
          <option value="box">Коробочное 4-4-4-4</option>
          <option value="478">4-7-8 (успокоение)</option>
          <option value="coherent">Когерентное 5-5 (фокус)</option>
          <option value="custom">Свой режим</option>
          <optgroup label="Мои режимы" id="savedModesGroup"></optgroup>
        </select>
      </div>

      <div class="field">
        <label for="session">Длительность сессии</label>
        <select id="session">
          <option value="1">1 мин</option>
          <option value="3" selected>3 мин</option>
          <option value="5">5 мин</option>
          <option value="10">10 мин</option>
        </select>
      </div>

      <div class="field">
        <label>Подсказки</label>
        <div class="opt"><input type="checkbox" id="sound" checked><label for="sound">Звук (тик)</label></div>
        <div class="opt"><input type="checkbox" id="haptics" checked><label for="haptics">Вибро (мобильные)</label></div>
      </div>
    </section>

    <section id="customFields" class="field" style="display:none" aria-label="Свой режим">
      <label>Фазы (сек.)</label>
      <div class="row">
        <div>
          <label for="cIn">Вдох</label>
          <input id="cIn" type="number" inputmode="decimal" min="0.5" max="60" step="0.5" value="4" />
        </div>
        <div>
          <label for="cH1">Задержка</label>
          <input id="cH1" type="number" inputmode="decimal" min="0" max="60" step="0.5" value="4" />
        </div>
        <div>
          <label for="cOut">Выдох</label>
          <input id="cOut" type="number" inputmode="decimal" min="0.5" max="60" step="0.5" value="4" />
        </div>
        <div>
          <label for="cH2">Задержка</label>
          <input id="cH2" type="number" inputmode="decimal" min="0" max="60" step="0.5" value="4" />
        </div>
      </div>
      <div class="custom-actions">
        <button type="button" id="saveCustom" class="btn small">Сохранить режим</button>
        <button type="button" id="deleteCustom" class="btn small ghost" style="display:none">Удалить</button>
      </div>
    </section>

    <section id="modeInfo" class="mode-info" aria-live="polite">
      <h2 id="modeInfoTitle">Коробочное 4-4-4-4</h2>
      <p id="modeInfoDesc">Классический ритм для быстрого восстановления после стресса.</p>
      <div class="mode-tags" id="modeTags"></div>
      <div class="mode-steps" id="modeSteps">Вдох 4 с → Задержка 4 с → Выдох 4 с → Задержка 4 с</div>
    </section>

    <section class="stage" aria-live="polite">
      <div id="progressTrack" class="bar" role="progressbar" aria-label="Прогресс сессии" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0">
        <i id="progress"></i>
      </div>
      <div class="hint"><span class="kbd">Space</span> — старт/пауза</div>
    </section>

    <section class="big" aria-label="График дыхания">
      <div class="graph">
        <svg id="breathSvg" viewBox="0 0 100 100" preserveAspectRatio="none" aria-hidden="true">
          <defs>
            <linearGradient id="graphGradient" x1="0" y1="0" x2="0" y2="1">
              <stop offset="0%" stop-color="#8ab4ff" stop-opacity="0.28" />
              <stop offset="65%" stop-color="#a1ffcf" stop-opacity="0.2" />
              <stop offset="100%" stop-color="#a1ffcf" stop-opacity="0" />
            </linearGradient>
          </defs>
          <g class="graph-grid">
            <line x1="0" y1="18" x2="100" y2="18"></line>
            <line x1="0" y1="50" x2="100" y2="50"></line>
            <line x1="0" y1="82" x2="100" y2="82"></line>
          </g>
          <line class="graph-axis" x1="0" y1="92" x2="100" y2="92"></line>
          <polygon id="graphArea" points="0,82 100,82 100,100 0,100"></polygon>
          <polyline id="graphLine" points="0,82 100,82"></polyline>
          <polyline id="graphLineActive" points="0,82 100,82"></polyline>
          <circle id="graphDot" cx="0" cy="82" r="2.4"></circle>
        </svg>
      </div>
      <div id="phase" class="phase">Готовы?</div>
      <div class="sub" id="sub">Выберите режим и нажмите Старт</div>
    </section>

    <div class="actions">
      <button id="start" class="btn">Старт</button>
      <button id="finish" class="btn secondary" disabled>Завершить</button>
    </div>

    <footer>
      <div class="stats">
        <span id="statToday">Сегодня: 0</span>
        <span id="statTotal">Всего: 0</span>
      </div>
      <div>
        <span class="kbd">1</span>/<span class="kbd">2</span>/<span class="kbd">3</span>/<span class="kbd">4</span> — режимы
      </div>
    </footer>
  </div>

  <div class="visually-hidden" aria-live="assertive" id="ariaPhase"></div>

  <script src="app.js" defer></script>

  <!-- Примечание: это не медицинское изделие. Если есть проблемы с дыханием, проконсультируйтесь с врачом. -->
</body>
</html>
